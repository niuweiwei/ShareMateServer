<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sharemate.server.dao.CommentMapper">

	<resultMap type="com.sharemate.entity.Comment" id="commentMap">
		<id property="commentId" column="comment_id"/>
		<result property="commentDetail" column="comment_detail"/>
		<result property="commentDate" column="comment_date"/>
		<association property="user"
			column="{id=user_id}"
			select="com.sharemate.server.dao.UserMapper.getUserByUserId"></association>
		<association property="note"
			column="{noteId=note_id}"
			select="com.sharemate.server.dao.NoteMapper.getNoteByNoteId"></association>
	</resultMap>

	<!-- 根据用户的id查询该用户发布过的所有评论 -->
	<select id="getCommentListByUserId" resultMap="commentMap">
		select * from comment where user_id = #{userId}
	</select>
	<!-- 根据评论的id查询评论详情 -->
	<select id="getCommentByCommentId" resultMap="commentMap">
		select * from comment where comment_id=#{commentId}
	</select>
	<!-- 根据笔记的id查询该笔记的所有评论 -->
	<select id="getCommentListByNoteId" resultMap="commentMap">
		select * from comment where note_id = #{noteId}
	</select>
	<!-- 根据评论id删除评论表中的某一条评论 -->
	<delete id="commentId">
		delete from comment where comment_id = #{commentId}
	</delete>
</mapper>